(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{759:function(s,n,a){"use strict";a.r(n);var e=a(7),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("这里狂神的视频较为简单，现在这样学习，后续继续学习，总结这部分，另外，开启高级部分的学习，可以先借助面试经验来指导学习。")])]),s._v(" "),a("blockquote",[a("p",[s._v("事务")])]),s._v(" "),a("p",[s._v("要么都成功，要么都失败。")]),s._v(" "),a("p",[s._v("将一组SQL放在一个批次中去执行。")]),s._v(" "),a("p",[a("strong",[s._v("事务原则：ACID原则")]),s._v("       原子性，一致性，隔离性，持久性")]),s._v(" "),a("ul",[a("li",[s._v("原子性：要么都成功，要么都失败")]),s._v(" "),a("li",[s._v("一致性：事务前后的数据完整性要保证一致")]),s._v(" "),a("li",[s._v("持久性：事务一旦提交就不可逆，被持久化到数据库中")]),s._v(" "),a("li",[s._v("隔离性：指的是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。")])]),s._v(" "),a("p",[a("strong",[s._v("以下是隔离所导致的一些问题")]),s._v("：")]),s._v(" "),a("ul",[a("li",[s._v("脏读：指的是一个事务读取了另外一个事务未提交的数据。")]),s._v(" "),a("li",[s._v("不可重复读：在一个事务内读取表中的某一行数据，多次读取结果不同。（这个不一定是错误，只是某些场合不对）")]),s._v(" "),a("li",[s._v("虚读（幻读）：是指在一个事务内读取到了别的事务插入的数据，导致前后读取不一致。")])]),s._v(" "),a("p",[a("strong",[s._v("mysql中事务的基本语法")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 使用set语句来改变自动提交模式\nSET autocommit = 0;   /*关闭*/\nSET autocommit = 1;   /*开启*/\n\n-- 注意:\n--- 1.MySQL中默认是自动提交\n--- 2.使用事务时应先关闭自动提交\n\n\n-- 手动处理事务\nSET autocommit = 0 -- 关闭自动提交\n-- 开始一个事务,标记事务的起始点\nSTART TRANSACTION  \n\nINSERT XXX\nINSERT XXX\n\n-- 提交一个事务给数据库(成功就提交)\nCOMMIT\n\n-- 将事务回滚,数据回到本次事务的初始状态(失败就回滚)\nROLLBACK\n\n-- 还原MySQL数据库的自动提交\nSET autocommit =1;\n\n-- 保存点\nSAVEPOINT 保存点名称 -- 设置一个事务保存点\nROLLBACK TO SAVEPOINT 保存点名称 -- 回滚到保存点\nRELEASE SAVEPOINT 保存点名称 -- 删除保存点\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[a("strong",[s._v("模拟一个场景")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n课堂测试题目\n\nA在线买一款价格为500元商品,网上银行转账.\nA的银行卡余额为2000,然后给商家B支付500.\n商家B一开始的银行卡余额为10000\n\n创建数据库shop和创建表account并插入2条数据\n*/\n\nCREATE DATABASE `shop`CHARACTER SET utf8 COLLATE utf8_general_ci;\nUSE `shop`;\n\nCREATE TABLE `account` (\n`id` INT(11) NOT NULL AUTO_INCREMENT,\n`name` VARCHAR(32) NOT NULL,\n`cash` DECIMAL(9,2) NOT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=INNODB DEFAULT CHARSET=utf8\n\nINSERT INTO account (`name`,`cash`)\nVALUES('A',2000.00),('B',10000.00)\n\n-- 转账实现\nSET autocommit = 0; -- 关闭自动提交\nSTART TRANSACTION;  -- 开始一个事务,标记事务的起始点\nUPDATE account SET cash=cash-500 WHERE `name`='A';\nUPDATE account SET cash=cash+500 WHERE `name`='B';\nCOMMIT; -- 提交事务\n# rollback;\nSET autocommit = 1; -- 恢复自动提交\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("blockquote",[a("p",[s._v("索引")])]),s._v(" "),a("p",[s._v("Mysql官方对于索引的定义为："),a("font",{staticStyle:{color:"red"}},[s._v("索引（index）是帮助Mysql高效获取数据的数据结构")]),s._v("。")],1),s._v(" "),a("p",[s._v("提取句子主干，就可以得到索引的本质：索引是数据结构。")]),s._v(" "),a("p",[a("strong",[s._v("索引的作用")]),s._v("：")]),s._v(" "),a("ul",[a("li",[s._v("提高查询速度")]),s._v(" "),a("li",[s._v("确保数据的唯一性"),a("mark",[s._v("???")])]),s._v(" "),a("li",[s._v("可以加速表和表之间的连接，实现表和表之间的参照完整性")]),s._v(" "),a("li",[s._v("使用分组和排序子句进行数据检索时，可以显著减少分组和排序的时间"),a("mark",[s._v("???")])]),s._v(" "),a("li",[s._v("全文检索字段进行搜索优化"),a("mark",[s._v("???")])])]),s._v(" "),a("p",[a("strong",[s._v("索引的分类")]),s._v("：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("主键索引 PRIMARY KEY")]),s._v(" "),a("ul",[a("li",[s._v("唯一的标识，主键不能重复，只能有一个列作为主键")])])]),s._v(" "),a("li",[a("p",[s._v("唯一索引 UNIQUE KEY")]),s._v(" "),a("ul",[a("li",[s._v("避免重复的列出现"),a("mark",[s._v("???")])]),s._v(" "),a("li",[s._v("唯一索引可以重复，多个列都可以标识为唯一索引")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE TABLE `Grade`(\n  `GradeID` INT(11) AUTO_INCREMENT PRIMARYKEY,\n  `GradeName` VARCHAR(32) NOT NULL UNIQUE\n   -- 或 UNIQUE KEY `GradeID` (`GradeID`)\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("常规索引 KEY/INDEX")]),s._v(" "),a("ul",[a("li",[s._v("默认的，index或者key关键字来设置")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE TABLE `result`(\n   -- 省略一些代码\n  INDEX/KEY `ind` (`studentNo`,`subjectNo`) -- 创建表时添加\n)\n\nCREATE TABLE `result`(\n   -- 省略一些代码\n  INDEX/KEY `ind` (`studentNo`,`subjectNo`) -- 创建表时添加\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("全文索引 FullText")]),s._v(" "),a("ul",[a("li",[s._v("作用是快速定位数据")])])])]),s._v(" "),a("p",[a("strong",[s._v("基本命令测试索引")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 显示所有的索引信息\nSHOW INDEX FROM student\n\n-- 增加一个全文索引  （索引名）列名   (注意使用ALTER指令修改一张表)\nALTER TABLE school.student ADD FULLTEXT INDEX  `studentName`(`studentName`)\n\n-- EXPLAIN 分析sql执行的状况\nEXPLAIN SELECT * FROM student; -- 非全文索引\nEXPLAIN SELECT * FROM student WHERE(studentName) AGAINST('刘');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("img",{attrs:{src:"C:%5CUsers%5Chp%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220309113336759.png",alt:"image-20220309113336759"}})]),s._v(" "),a("p",[a("strong",[s._v("SQL编程测试一百万条数据")]),s._v("测试索引：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 建表app_user\nCREATE TABLE `app_user` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`name` varchar(50) DEFAULT '' COMMENT '用户昵称',\n`email` varchar(50) NOT NULL COMMENT '用户邮箱',\n`phone` varchar(20) DEFAULT '' COMMENT '手机号',\n`gender` tinyint(4) unsigned DEFAULT '0' COMMENT '性别（0:男；1：女）',\n`password` varchar(100) NOT NULL COMMENT '密码',\n`age` tinyint(4) DEFAULT '0' COMMENT '年龄',\n`create_time` datetime DEFAULT CURRENT_TIMESTAMP,\n`update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='app用户表'\n\n-- 批量插入数据：100w\nDROP FUNCTION IF EXISTS mock_data; -- 写函数之前必须要写，标志:$$\nDELIMITER $$\nCREATE FUNCTION mock_data()\nRETURNS INT -- 注意returns，否则报错。\nDETERMINISTIC -- 8.0版本需要多这么一行\nBEGIN\n\tDECLARE num INT DEFAULT 1000000; -- num 作为截止数字，定义为百万，\n\tDECLARE i INT DEFAULT 0;\n\tWHILE i < num DO\n\t INSERT INTO app_user(`name`, `email`, `phone`, `gender`, `password`, `age`)VALUES(CONCAT('用户', i),'965499224@qq.com', CONCAT('13', FLOOR(RAND()*(999999999-100000000)+100000000)),FLOOR(RAND()*2),UUID(), FLOOR(RAND()*100));\n\tSET i = i + 1;\n\tEND WHILE;\n\tRETURN i;\nEND;\nSELECT mock_data();\n\n-- 索引效率测试\n-- 无索引\nSELECT * FROM app_user WHERE NAME = '用户9999'; -- 6.474 sec  992551条才找到他\n\n-- 创建索引\n-- CREATE INDEX 索引名 on 表(字段)\nCREATE INDEX idx_app_user_name ON app_user(name);\n-- 测试普通索引\nSELECT * FROM app_user WHERE NAME = '用户9999'; -- 0.001 sec  查1条就能找到他，就是唯一定位了，不像没有用索引时候的遍历了\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("p",[s._v("索引在小数据量的时候，用户不大，但是在大数据的时候，区别十分明显。")]),s._v(" "),a("p",[a("strong",[s._v("索引原则")])]),s._v(" "),a("ul",[a("li",[s._v("索引不是越多越好")]),s._v(" "),a("li",[s._v("不要对进程变动数据加索引")]),s._v(" "),a("li",[s._v("小数据量的表不需要加索引")]),s._v(" "),a("li",[s._v("索引一般加在常用来查询的字段上")])]),s._v(" "),a("p",[a("strong",[s._v("索引的数据结构")])]),s._v(" "),a("p",[s._v("https://www.cnblogs.com/tgycoder/p/5410057.html")]),s._v(" "),a("ul",[a("li",[s._v("Hash类型的索引")]),s._v(" "),a("li",[s._v("Btree：InnoDb的默认数据结构")])])])}),[],!1,null,null,null);n.default=t.exports}}]);